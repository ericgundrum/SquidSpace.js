# SquidSpace.js Module Files 

SquidSpace.js Module Files are JSON data used as inputs to several of the SquidSpace.js tools. In particular they are inputs to the SquidSpace.js tools to manage the asset pipeline and to generate runtime Javascript.

All Module Files must conform to the [Module File Specification](modulefile-specification.md). However, that specification does not specify the content values of configuration, options, and data subsections of the different object types; leaving that to the implementation. In general, configuration ("config") sections are used by tools that read and use Module Files to do work. Options ("options") and Data ("data") subsections are used by the runtime API and are usually passed through by the tools unchanged or with minimal modification; although for resources the code generation tools may create the data section at runtime based on the configuration.

This document specifies the configuration subsection values supported by the SquidSpace.js tools. For more details on the tools please see the (tool documentation)[squidspace-tools.md]. It also specifies the options and data subsection values used by the runtime SquidSpace.js API. For more details on the runtime API please see the (API reference)[squidspace-api.md]. 

This document is organized by "levels", starting from the top-level of the file and then drilling down through sections. The (Module File Specification)[modulefile-specification.md] details how the sections are organized and what values they may contain; this document only specifies the contents of the "config", "options" and "data" subsections of each section/object type level and is specific to SquidSpace.js.

## How Module Files are Used

Module Files may be used in a number of ways by different SquidSpace.js tools and by third-party tools. The two most common usages are Code Generation (packing) and Asset Pipeline Management (pipelines).

### Code Generation (Packing)

The Module File is used as input to a packer, which then generates some sort of application-specific code. The SquidSpace "spacepacker" utility generates an older-style javascript module, which allows loading without being blocked by CORS when the requesting HTML file is opened from a file system. If you "insert"
all of your 3D content into the generated modules you can run SquidSpace without requiring a web server. 

For more details on the module file interface generated by spacepacker, see the SquidSpace documentation. 

NOTE: It is possible to create your own SquidSpace content modules from scratch or to edit generated SquidSpace content modules. However, Module Files are almost certainly simpler to use.

### 3D Asset Pipeline Management (Pipelines)

TODO:

### Providing Project Defaults and Information

TODO:

## SquidSpace.js-Specific Module File Values

SquidSpace.js supports some special data values to extend the capapabilities of Module Files. These include Hook Function References and Event Subsections.

### Standard Values

TODO: (size, position, rotation, etc.)

### Hook Function References

SquidSpace.js supports "Hook Functions" that extend different classes of functionality. For some of these functionality classes the Hook Functions are named, in which case the that name may be referenced in the Module File data to use instead of the native SquidSpace.js functionality for that functionality class. There are also unnamed hook functions that are not referenced in the Module File but may invisibly modify SquidSpace.js behavior at runtime or when processing the Module File. For more detail on Hook Functions see the (SquidSpace.js API documentation)[squidspace-api.md] and the (SquidSpace.js Hooks documentation)[squidspace-hooks.md].
 
Examples:

	"objects": [
		{
			"name": "foo",
			"options": {
				"loader": "fooLoader",
				. . . Other object options values specific to fooLoader.
			},
			. . . Other object values.
		},
	],

### Events Subsections

Certain Module File sections may contain an "events" subsection. Each Event is specified by an event type and name and and what event types are available are context dependent. If a section supports events the allowed event types are detailed in this document. For more detail on Events see the (SquidSpace.js API documentation)[squidspace-api.md] and the (SquidSpace.js Events documentation)[squidspace-events.md].

Module File sections currently supporting Events in their options are:

* Modules – "World" modules can specify World-level events
	- TODO: Keypress events?

* Layout Areas - Each layout area can specify events related to objects and the area boundaries
	- TODO: List of layout area events

* Object Placements – Each object placement can specify events for that object when it is placed
	- "on-click": Makes the object clickable and fires related events when the object is clicked
	- TODO: Others

The Events subsection is a JSON array of Event JSON objects, each containing the following named values:

* "event" – [string; required] – Specifies the name to which all Event handlers for this event are bound

* "options" - [object; optional] – Contains options values passed to all handlers for the event at runtime when the Event is triggered

* "data" - [any type; optional] – Contains data passed to all handlers for the event at runtime when the Event is triggered

For example, if an "on-click" event is attached to an object in the layout object placements (see below), the Events subsection of the Object's options might look like this:

	{
		"object": "foo-object",
		"events": {
			"on-click": [
				{
					"event": "foo-click-event",
					"options": {
						"foo": "bar",
						"count": 3
					},
					"data": "bar"
				}
			]
		}
		. . . Other object placement values.
	}

If the user then clicks the "foo-object" object at runtime, every event handler assigned to "foo-click-event" is called in turn using the arguments `("foo-object", {"foo": "bar","count": 3}, "bar")`.

## Top (Global) Level 

The Top level of the file contains global values applying to the whole file. Besides the "config", "options" and "data" subsections the Top level contains a Modules ("modules") subsection. 

Example:

	{
		"doc": "Top level.",
		"config": {
			. . . Zero or more global configuration values.
		},
		TODO: Other stuff.
	}

### Global Configuration

Global configuration must be of type JSON object. Global configuration for the main world Module File sets the defaults for all related Module Files. Global configuration of non-world Module Files may override any provided world Module File global configuration values.

* "out-dir" – [optional, string] – Directory to write output Javascript output modules to, used by the spacepack tool; can be overridden for individual modules; default value depends on the tool reading the Module File

* "texture-dir" – [optional, string] – Directory containing textures to import; can be overridden for individual textures; default value depends on the tool reading the Module File

* "material-dir" – [optional, string] – Directory containing materials to import; can be overridden for individual materials; default value depends on the tool reading the Module File

* "object-dir" – [optional, string] – Directory containing objects to import; can be overridden for individual objects; default value depends on the tool reading the Module File

* "mod-dir" – [optional, string] – Directory containing mods or other Javascript files to import; can be overridden for individual mods; default value depends on the tool reading the Module File

* "pretty-print" – [optional, boolean, default is false] – If true, all module not specifying otherwise are formatted to be readable, using the "pretty-offset" value for formatting; if false the module is "packed"; can be overridden for individual modules

* "pretty-offset" – [optional, positive integer or zero, default is "3"] – The number of spaces to offset when pretty printing; can be overridden for individual modules

Example:

	{
		"doc": "Top level.",
		"config": {
			"Global configuration."
			"out-dir": "build/",
			"texture-dir": "assets/textures/",
			"material-dir": "assets/materials/",
			"object-dir": "assets/objects/",
			"mod-dir": "supportlibs/mods/",
			"pretty-print": true,
			"pretty-offset": 3
		},
		. . . Other module values.
	}

### Global Options

Global options must be of type JSON object. The following named values are supported:

* "world-origin" – [optional if config:is-world is true, otherwise do not use, array of x, y, z values] Used to specify the NW corner of the world as an origin point; defaults to [0, 0, 0]

TODO: Example

### Global Data

None at this time.

### Global Events

None at this time.

TODO: World-level events, such as "on-keypress".

## Resources

Resources are JSON objects that contain none, some, or all of Textures ("textures"), Materials ("materials"), Objects ("objects"), Lights ("lights") and Mods ("mods") subsections. Each of these resource types are used at runtime by SquidSpace.js via a Loader Hook Function. (See Loader Hook Functions below.) 

Example:

	{
		"name": "exampleModule",
		"doc": "Module containing a resources section.",
		"resources": {
			"textures": [
				. . . Zero or more texture resources.
			],
			"materials": [
				. . . Zero or more material resources.
			],
			"object": [
				. . . Zero or more object resources.
			],
			"mods": [
				. . . Zero or more mod resources.
			]
		},
		. . . Other module values.
	},

### Resource Data Caching

Besides controlling data packing during code generation, Module Files may also be used to manage an asset pipeline that manages a local resource cache, with optional optimization. This means there are three ways to manage file resources:

1. Local – The file is stored locally and may be accessed using a relative file path from the directory containing the Module File; "Local" files may be used with either "Insert" or "Link" ("Local" files are already in the cache)

3. Cached – The file is copied from a fully qualified file location or from a URL to a local file path and optimized if necessary, after which it is available with a relative file path exactly like a "Local" file; "Cached" files may be used with either "Insert" or "Link" ("Cached" files are added to the cache)

2. Remote – The file is kept at remote location and always loaded from a fully qualified URL; "Remote" files may only be used with "Link" ("Remote" files are not cached and may even not be served from the same base URL if CORS headers are set up properly)

The directories used for "Local" or "Cached" files are specified in the global configuration. (See Global Configuration.)

Resource Data Caching is not a runtime functionality, therefore all cache control values are specified in the resource configuration. (See Standard Resource Configuration.)

Whether and how files are cached is specified in the configuration subsection of each individual resource.

IMPORTANT! It may be nescessary to run asset pipeline management tools against a Module File to pre-load the cache before you can run the code generation tools, in cases where the file data is to be inserted.

### Resource Data Packing

Some resources may be specified entirely within the Module File using the option and data subsections. However, other resources may require external asset files of some kind. In the latter case SquidSpace.js provides a three ways to get the file data at runtime:

1. None – No file is used, if the specified Loader Hook Function requires data of some kind it is encoded directly into the Module File as a "data" subsection and copied into the generated code as the "data" value (basically the data is already 'packed')

2. Insert – The full contents of a file or URL are inserted directly into the generated code as the "data" value; using binary encoding, if required (in this way "Insert" is exactly like "None", except the data is 'packed' from a file)

3. Link – The contents of the file are loaded externally at runtime using a fully-specified URL or a relative link copied into the generated code as the "data" value

Advantages of "Insert" and "None" include the ability to load resources from the file system without experiencing CORS limitations and reducing the number of separate network streams required; with faster load times and no lost data due to network timeouts. Disadvantages of "Insert" and "None" includes the possibility of generating very large output files during the Pack step. In most cases "Insert" and "None" provide the best performance and stability.

Advantages of "Link" include the ability to utilize an external resource that might change over time and no CORS issues if your page headers are properly set up and you are not running from the file system. Disadvantages of Link include an increased number of network requests, lost data if the network times out, or the possibility the external resource may not be available at all for some reason.

Resource Data Packing is not a runtime functionality, therefore all pack control values are specified in the resource configuration. (See Standard Resource Configuration.) 

Whether and how data is packed is specified in the configuration subsection of each individual resource.

### Resource Loader Hook Functions

Resource Loader Hook Functions are added to SquidSpace.js at runtime by name and resource type before the buildWorld() API is called. For this reason a loader hook for a Texture resource can have the same name as a loader hook for a light resource, and so on. (See Hook Function References.)

TODO: 
	
NOTE: Resource Loader Hooks allow for alternative data loading methods, pre-defined resources (builtins) which are created from code, or any other resources created outside of the regular resource loading functionality. For more detail on Hook Functions see the [SquidSpace.js API documentation](squidspace-api.md) and the [SquidSpace.js Hooks documentation](squidspace-hooks.md).

### Standard Resource Configuration

All resource configuration subsections provide the following standard resource configuration values:

* "cache-options" – [optional, JSON object] – Specifies file cacheing options for the resource, default is no cacheing (local file resource only), options are:
	- "file-source" – [optional, string containing a fully-qualified file path; do not use if "url-source" is specified] – Specifies the source of the data to cache
	- "url-source" – [optional, string containing a fully-qualified URL; do not use if "file-source" is specified] – Specifies the source of the data to cache
	- "optimizations" – [optional, JSON object containing optimization settings for the file] – Specifies the optimizations to perform on the data when it is being cached or inserted; the specific optimization values are specified differently for each file type and are documented in the tools; if not provided the default optimizations for the file type are applied and may depend on asset management plugins

* "pack-options" – [optional, JSON object] – Specifies file packing options for the resource, default is no packing (use "data" value as-is), options are:
	- "action": [optional, string containing one of "none", "insert", "link"] – Specifies file packing options for the resource, default is "none"
	- TODO: Other options?

* "dir" – [optional, string; use only if "file-name" is also specified] – Directory containing the file resource; overrides the global "dir" value for the resource section; when doing cacheing also specifies the directory the file is cached in

* "file-name" – [required if "pack" is "insert" optional if "pack" is "link", string; do not use if "url" is specified, do not use if "pack" is "none"] – Specifies the file resource in the related resource directory; when doing cacheing also specifies the file name of the cached file

* "url" – [optional if "pack" is "link", string containing a fully-qualified URL; do not use if "file-name" is specified, do not use if "pack" is "insert" or "none"] – Specifies the file resource URL

During asset pipeline management, if "cache-options" is not supplied the resource is ignored. Otherwise the file will be cached during asset pipeline management. This means the file is fetched from the source specified in the "cache-options", selected optimizations are performed on the file, and then the file is saved to the related resource directory using the "file-name" value. (See Resource Data Caching.) For this reason the "cache-options" subsection must contain one of a "file-source" or a "url-source" value referring to a valid file of the correct resource type and, minimally, the "file-name" must also be specified in the configuration. Do not specify a "url" in the configuration.

During code generation, if the "pack-options" is not supplied or the "action" is "none" the resource "options" and "data" subsections are used as-is. If "action" is "link" and a "file-name" value is specified it is assumed the file will be served locally using a relative URL from the related resource directory and the resource "data" value will be a JSON object containing the keys "dir" and "file-name". If "pack" is "link" and a "url" value is specified it is assumed the file will be served remotely and the resource "data" value will be a JSON object containing the key "url". If "pack" is "insert" and a "file-name" value is specified, the file will be opened and inserted into the resource "data" value as a string. 

Examples:

	"textures": [
		{
			"name": "foo",
			"config": {
				"doc": "No cache, no pack. (Default.) No 'config' subsection results in same behaviour.",
				"pack-options": {
					"action": "none"
				},
			},
			. . . Other texture values.
		},
		{
			"name": "bar",
			"config": {
				"doc": "No cache, local link.",
				"pack-options": {
					"action": "link"
				},
				"file-name": "bar.png"
			},
			. . . Other texture values.
		},
		{
			"name": "barinsert",
			"config": {
				"doc": "No cache, insert local file.",
				"pack-options": {
					"action": "insert"
				},
				"file-name": "bar.png"
			},
			. . . Other texture values.
		},
		{
			"name": "barcachelink",
			"config": {
				"doc": "Cache, local link. Local source.",
				"cache-options": {
					"file-source": "~/images/bar.png"
				},
				"pack-options": {
					"action": "link"
				},
				"file-name": "bar.png"
			},
			. . . Other texture values.
		},
		{
			"name": "barcacheinsert",
			"config": {
				"doc": "Cache, insert cached file.",
				"cache-options": {
					"file-source": "~/images/bar.png"
				},
				"pack-options": {
					"action": "insert"
				},
				"file-name": "bar.png"
			},
			. . . Other texture values.
		},
		{
			"name": "baz",
			"config": {
				"doc": "No cache, remote link.",
				"pack-options": {
					"action": "link"
				},
				"url": "http://example.com/images/baz.png"
			},
			. . . Other texture values.
		},
		{
			"name": "bazcachelink",
			"config": {
				"doc": "Cache, local link. Remote source.",
				"cache-options": {
					"url-source": "http://example.com/images/baz.png"
				},
				"pack-options": {
					"action": "link"
				},
				"file-name": "baz.png"
			},
			. . . Other texture values.
		},
		. . . Other textures.
	],

TODO: Pack options? 

### Standard Resource Options

The following Standard Resource Options are supported:

* "loader" - [optional, string containing a loader hook name, default is 'default'] – Specifies the loader hook function to use for the resource; see Hook Function References

Some resource types have their own standard options and Resource Loader Hooks may require options specific to the loader hook function.

TODO: Example

### Standard Resource Data

If the options "loader" value is a Resource Loader Hook Function the resource data subsection may contain any values expected by the Hook Function using any valid JSON type, including JSON objects and arrays. Module File extension value types such as Expression Strings and Binary Strings are allowed.

If the configuration specifies a "pack-options" subsection with an "action" value other than "none" the resource data subsection values are copied in from an external source; overwriting any values supplied for the data subsection. (See "pack-options" in the resource configuration section above.) When you are specifying a configuraton source any data section value you also specify will be overwritten with the data from the source. This means if you do specify a custom data subsection for a resource loader hook you must not specify "pack-options" in the configuration. 

TODO: Example

### Standard Resource Events

There are no standard resource events. The only resource type that supports events is 'Object'. See Objects.

## Textures

Textures are an array of Texture JSON objects specified with the key "textures" from the Resources level. Textures do not have subsections other than "config", "options", and "data". Textures do not support events.

Textures consists of image data that will be applied to a material. See Materials.

TODO: Examples.

### Built-in Texture Loaders

SquidSpace.js provides the following 'built in' texture hooks:

* 'default' – A basic texture data loader that uses the built-in SquidSpace.loadTexture() function, which in turn is based on the Babylon.js Texture() constructor

* TODO: Various built-in procedural texture loaders

For more details on SquidSpace.js built-in loader functons, including their options and data values, see the [SquidSpace.js API Documentation](squidspace-api.md)

NOTE: One common way to create a custom loader hook is to call a built-in loader function from your hook function and then modify the returned texture for your specific requirements.

NOTE: The SquidSpace.js squidcommons mod provides a number of other commonly used loaders. 
TODO: Implement and document squidcommons.js.

### Texture Configuration

Texture resources support the Standard Resource Configuration. Textures created using the 'default' texture loader are likely to require data file or URL configuration. 

TODO: Example

### Texture Options

Texture resources support the Standard Resource Options. Other options are dependent on the loader hook specified.

TODO: Example

#### 'default' Texture Loader Options

The following options are specific to the texture resource 'default' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "no-mipmap" – [optional, boolean, default is false] – Specifies if the texture will require mip maps or not

* "invert-y" – [optional, boolean, default is false] – Specifies if the texture needs to be inverted on the y axis during loading

* "mime-type" – [optional, string, default is none] – Specifies optional mime type information

### Texture Data

Texture resources supports the Standard Resource Data values. The data should specify all the geometry/meshes for a single object added to the space.

Texture resources support the Standard Resource Data using a standard image data type. Currently SquidSpace.js only supports data for non builtin textures.

TODO: Example

#### 'default' Texture Loader Data 

The texture resource 'default' loader hook supports the Standard Resource Data using configuration "pack-options", where the data is a supported image file type. See Standard Resource Configuration and Standard Resource Options.
   
## Materials

Materials are an array of Material JSON objects specified with the key "materials" from the Resources level. Materials do not have subsections other than "config", "options", and "data". Materials do not support events.

Materials consists of processed textures that will be applied to a objects. See Objects.

TODO: Example

### Built-in Material Loaders

SquidSpace.js provides the following 'built in' material hooks:

* 'default' – A basic material data loader that uses the built-in SquidSpace.loadMaterial() function, which in turn is based on the Babylon.js StandardMaterial() constructor

* TODO: Various built-in procedural and shader material loaders

For more details on SquidSpace.js built-in loader functons, including their options and data values, see the [SquidSpace.js API Documentation](squidspace-api.md)

NOTE: One common way to create a custom loader hook is to call a built-in loader function from your hook function and then modify the returned material for your specific requirements.

NOTE: The SquidSpace.js squidcommons mod provides a number of other commonly used loaders. 
TODO: Implement and document squidcommons.js.

### Material Configuration

At this time Materials do not have a data type that can be specified for inserting or loaded via a URL. All materials are specified with a Resource Loader Hook Function and their option and data values are dependent on the named Resource Loader Hook Function in the configuration.

### Material Options

Material resources support the Standard Resource Options. Other options are dependent on the loader hook specified.

TODO: Example

#### 'default' Material Loader Options

The following options are specific to the meterial resource 'default' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* TODO: specular options.

* TODO: orientation options.

* TODO: Alpha support options.

### Material Data

Material resource data values and types are dependent on the Resource Loader Hook Function specified in the material Options.

TODO: Example

#### 'default' Material Loader Data

The following data values are specific to the meterial resource 'default' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "diffuse-color" – [optional, array of 3 color values, default is none, do not use if diffuse-texture is specified] – Specifies a diffuse color 

* "specular-color" – [optional, array of 3 color values, default is none, do not use if specular-texture is specified] – Specifies a specular color 

* "emissive-color" – [optional, array of 3 color values, default is none, do not use if emissive-texture is specified] – Specifies a emissive color 

* "ambient-color" – [optional, array of 3 color values, default is none, do not use if ambient-texture is specified] – Specifies a diffuse color 

* "diffuse-texture" – [optional, string name of a texture, default is none, do not use if diffuse-color is specified] – Specifies a diffuse texture

* "specular-texture" – [optional, string name of a texture, default is none, do not use if specular-color is specified] – Specifies a specular texture

* "emissive-texture" – [optional, string name of a texture, default is none, do not use if emissive-color is specified] – Specifies a emissive texture

* "ambient-texture" – [optional, string name of a texture, default is none, do not use if ambient-color is specified] – Specifies a diffuse texture

* TODO: other textures (reflection, refraction, others?)

## Objects

Objects are an array of 3D Object JSON objects specified with the key "objects" from the Resources level. Objects do not have subsections other than "config", "options", "data" and "events".

NOTE: Lights and user cameras are considered a special case of 'Object' and are specified in the Objects section using special Object Loader hooks functions.

TODO: Examples.

### Built-in Object Loaders

SquidSpace.js provides the following 'built in' loader hooks:

* 'default' – A basic object data loader that uses the built-in SquidSpace.loadObject() function, which in turn is based on the Babylon.js SceneLoader.ImportMesh() function

* 'floor' – A basic object builder/loader that uses the SquidSpace.makeFloor() function, which in turn is based on the Babylon.js Mesh.CreateGround() function

* 'user-camera' – A basic object builder/loader that uses the SquidSpace.makeUserCamera() function, which in turn is based on the Babylon.js UniversalCamera() function

* TODO: Other built-in object loader hooks. (floor, light, user camera, plane, basic geometry)

For more details on SquidSpace.js built-in loader functons, including their options and data values, see the [SquidSpace.js API Documentation](squidspace-api.md)

NOTE: One common way to create a custom loader hook is to call a built-in loader function from your hook function and then modify the returned meshes for your specific requirements.

NOTE: The SquidSpace.js squidcommons mod provides a number of other commonly used loaders. 
TODO: Implement and document squidcommons.js.

### Object Configuration

Object resources support the Standard Resource Configuration. Objects created using the 'default' object loader are likely to require data file or URL configuration.

### Object Options

Object resources support the Standard Resource Options. Other options are dependent on the loader hook specified.

#### 'default' Object Loader Options

The following options are specific to the object resource 'default' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "visible" – [optional, boolean, default is false] – Specifies that the object is made visible in the space at startup using the object's own position data; otherwise the object is a "layout object" and is made invisible in the space at startup and must be placed into the space using a layout (see also, Area  Layouts below)

* "collision-detection" - [optional, boolean, default is true] – Specifies if collision detection is on for the object

* "mesh-name-filter" - [optional, string or array of strings, default is no filter] – Specifies one or more submeshes of the object which will be imported; filtering out other submeshes

* "loader-plugin" – [required if the object file type is not ".babylon", otherwise do not use, string containing a file extension, default is ".babylon"] – Used to specify the Babylon.js object loading plugin to use by file name extension; currently supported loader plugin values include:
	 - ".obj"
	 - ".gltf"
	 - ".glb"
	 - ".stl"

* "events" - [optional, events subsection (see Events Subsections above)] – Supported events:
   - "on-click" – Makes object clickable in the 3D space
   - TODO: Other supported events.
   
* TODO: Other loadObject() function options

#### 'floor' Object Loader Options

The following options are specific to the object resource 'floor' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "visible" – [optional, boolean, default is false] – Specifies that the object is made visible in the space at startup using the object's own position data; otherwise the object is a "layout object" and is made invisible in the space at startup and must be placed into the space using a layout (see also, Area  Layouts below)

* "collision-detection" - [optional, boolean, default is true] – Specifies if collision detection is on for the object. 

* "gravity" - [TODO] – Specifies the amount and direction of the floor's gravity
   
* TODO: Other loadObject() function options

#### 'user-camera' Object Loader Options

The following options are specific to the object resource 'user-camera' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "visible" – [optional, boolean, default is false] – Specifies that the object is made visible in the space at startup using the object's own position data; otherwise the object is a "layout object" and is made invisible in the space at startup and must be placed into the space using a layout (see also, Area  Layouts below)

* "collision-detection" - [optional, boolean, default is true] – Specifies if collision detection is on for the object

* "fly" - [optional, boolean, default is false] – Specifies if the user camera is affected by gravity
   
* TODO: Other options

### Object Data

Object resources supports the Standard Resource Data values. The data should specify all the geometry/meshes for a single object added to the space.

#### 'default' Object Loader Data 

The object resource 'default' loader hook supports the Standard Resource Data using configuration "pack-options", where the data is a supported 3D object file type. See Standard Resource Configuration and Standard Resource Options.
   
#### 'floor' Object Loader Data

The following data values are specific to the object resource 'floor' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "size" - [requried, array of x, y, z values] – Specifies the size of the floor

* "position" - [optional, array of x, y, z values, default is 0, 0, 0] – Specifies the NW corner of the floor

* "material" - [optional, material name, default is no material] – Specifies the material to use for the floor
   
* TODO: Other data
   
#### 'user-camera' Object Loader Data

The following data values are specific to the object resource 'user-camera' loader hook; similar custom loader hooks should support these as well, unless the implementation and use case do not require them:

* "size" - [requried, array of x, y, z values] – Specifies the size of the user camera collision ellipsoid

* "position" - [optional, array of x, y, z values, default is 0, 0, 0] – Specifies the point position of the camera

* "target" - [optional, array of x, y, z values, default is 0, 0, 0] – Specifies the point position of the camera target (what it is looking at)
   
* TODO: Other data

### Object Events

TODO: Finish implementing and document.

## Mods

TODO: Rewrite and make work.

The Mods section of a module is an array containing one or more "modifier specs" to include in the output. There can be zero or more mod specs. Modifier are external code "wired into" the runtime system to make it behave differently. The Module File processor determines which modifiers are supported. Each modifier spec details how to wire in a single external code resource as processed by the Module File processor. A modifier spec consists of the following named objects, although a specific Module File processor may add others:

1. "mod" – (string; required) – the name of the modifier to wire, should be unique within the wiring array 

2. "doc" – (string; optional) – documentation for the modifier spec, use to describe what the modifier spec is for 

3. "config" – (object; optional, but may be required or ignored by some Module File processors) – modifier spec-specific configuration (See also, Configuation above)

4. "options" – (object; optional, but may be required or ignored by some Module File processors) – modifier spec-specific options (See also, Options above)

5. "data" – (any type; optional, but may be required or ignored by some Module File processors) – modifier spec-specific data (See also, Data above)

IMPORTANT! The Module File specification does not detail configuration, options, and data values for mod spec items. Please refer to the documentation for the Module File processor you will be using for more information.

### Mod Configuration

Mods are an array of Mod JSON objects specified with the key "mods" from the Resources level. Mods do not have subsections other than "config", "options", and "data". Mods do not support events.

### Mod Options

TODO: implement and document.

### Mod Data

TODO: implement and document.

## Layouts

Layouts are JSON arrays containing a list of Layout Area JSON objects. Layouts do not contain "config", "options" and "data" subsections.

## Layout Areas

Layout Areas are JSON objects specifying a single area within the 3D space, each of which contain zero or more "object placements" specifying what objects the Layout Area contains and where they are located. Layout areas are dimennsioned as rectangular with a width and depth and specified with an origin point based off of the world origin. 

Layout Areas are singlular, box shaped, and contiguous; but may overlap with other Layout Areas. The object placements they contain use the layout area origin point when placing "standalone" objects, but do not need to be located within the Layout Area.

### Layout Area Configuration

None at this time.

### Layout Area Options

Layout Area options must be of type JSON object. The following named values are supported:

* "size" – [required if the Layout Area is included in a World specification module, required if specifying a Layout Area not also specified in a World specification module, otherwise do not use; array of w, h, d values] Specifies the size of the layout area in terms of width (w), height (h), and depth (d) where w is east/west, h is up/down and d is north/south

* "origin" – [required if the Layout Area is included in a World specification module, required if specifying a Layout Area not also specified in a World specification module, otherwise do not use; array of x, y, z values] Used to specify the NW corner of the Layout Area as an origin point, based on the World origin point where x is east/west, y is up/down and z is north/south

TODO: Layout Area-level events, such as "on-keypress", "on-user-enter/leave", etc.

NOTE: When a Layout Area is specified in the World specification module and there is a Layout Area of the same name in another module, the "size" and/or "origin" values from the World specification module are used and the separate module's "size" and/or "origin" values are ignored. A common use case is to declare Layout Areas with no or few object placements in a World specification module and then re-use those named Layout Areas in other modules, adding other object placements in those modules.

### Layout Area Data

None at this time.

### Layout Area Events

TODO: Finish implementing and document.

## Object Placements

Object Placements are a JSON array of JSON objects specifying zero or more 'object placements'; each for a single object within a Layout Area. Object Placements contain zero or more 'placements' specifying the places that object is located. 

Object Placements specify a named object, which must have been loaded as a resource in the current module, loaded as a resource in a separate module belonging to the same world, or included as a "builtin" by the runtime. All of the contained placements are for the same object using the same Object Placement options.

WARNING! Specifying an object name that is not loaded results in undefined behavior. 

### Object Placement Configuration

None at this time.

### Object Placement Options

* "materials" – [optional, JSON array] – Specifies zero or more materials and the named submeshes to apply the materials to:
	- "material" – [required, name of a loaded material] - Specifies the material to use
	- "submesh" – [optional, name of a submesh within the object] – Specifies applying the named material to a named submesh; if not provided the material is applied to all submeshes

* "events" – [optional, Events subsection] – Specifies one or more events applying to all object placements

The Materials option specify a named material, which must have been loaded as a resource in the current module, loaded as a resource in a separate module belonging to the same world, or included as a "builtin" by the runtime. 

NOTE: Applying materials to an Object Placement creates a "clone" of the named object and all placements are instances of that clone. If no materials are applied all placements are instances of the original object. Generally clones create more geometry in the World space and use more memory and other runtime resources, so they should be avoided if possible.

WARNING! Specifying a material name that is not loaded results in undefined behavior. 

WARNING! Specifying multiple materials for the same submesh results in undefined behavior. 

### Object Placement Data

Object Placement Data consist of a JSON array of Placement objects. See Placements.

## Placements

Placements are JSON objects specifying the location in the World space of an instance of the object specified in the containing Object Placement. Each Placement must specify a named "placer" hook to use, which must be a SquidSpace.js builtin placer or a "Placer Hook" loaded from a mod. Placements must also specify a unique "place-name" used within the Layout Area for the object instance(s) being placed. 

NOTE: If a placer algorithm results in multiple instances of the object, the instances are named using the "place-name" specified, with a dash ('-") and a number appended, where that number is zero to the number of instances placed minus one.

### Placement Configuration

None at this time.

### Standard Placement Options

The following Standard Placement Options are supported:

* "placer" - [optional, string containing a placer hook name, default is 'default'] – Specifies the placer hook function to use for the object; see Hook Function References

Some Placer Hooks may require options specific to the placer hook function.

TODO: Example

### Standard Placement Data

Standard data values for all Placer Algorithms, both builtins and "placer hook functions" include:

* "position" – [optional; array of x, y, z values, defaults to [0, 0, 0]] – Specifies the position of the placed object; if "place-on-object" is not specified the position is based on the Layout Area's origin, otherwise the position is based on the named submesh's origin (TODO: Find out Babylon.js standard origin point for submeshes); see below for "place-on-object" values

* "rotation" – [optional; array of x, y, z rotation values, defaults to [0, 0, 0]] Specifies the rotation to apply to all submeshes of the object for each axis

All SquidSpace.js builtins "placer hook functions" also support:

* "place-on-object" – [optional; the name of an object previously placed in the World Space] – Specifies an object to place an instance of this Object Placement on

* "place-on-submesh" – [optional if "place-on-object" is specified, otherwise do not use; A submesh of the object specified with the "place-on-object" value

NOTE: A common submesh naming pattern for objects which will have other objects placed on them is to use "top", "bottom", "left", "right", "front", and "back" if possible. 

WARNING: "place-on-object" values are dependent on object loading order. This is determined by the order in which the Module File modules are passed to SquidSpace.js, where the first module loaded is *always* the World specification module, after which other Module File modules are loaded in an order specified when SquidSpace.js is initialized at runtime.

TODO: Find a way to remove the loading order issue. One option is to defer on-object placements until all objects are placed, but that raises the issue of what happens when you place an object on an object placed on another object.

TODO: Example

### Builtin Placer Algorithms

SquidSpace.js includes a number of builtin placer algorithms, any of which may be overridden by a "placer hook function" using the same name and using the same options. 

The builtin placer algorithms are:

* "single" (also "default") – Places a single instance of an object in a particular location; requires only standard placement options values

* "linear-series" - Places a row of instances of an object starting from a particular location; requires the standard placement options values, plus:
	- "count" – [required; integer] – Specifies number of object instances to place in a row
	- "across" – [optional; boolean, default is true] – Specifies whether the series goes from lesser "x" to a greater "x" value (true) or from lesser "z" to a greater "z" value (false)
	- "offset" – [optional; number, default is "0"] – Specifies in size units the offset between objects when they are placed, if a negative value the objects may overlap

* "rectangle-series" - Places a rectangle of instances of an object starting from a particular location; requires the standard placement options values, plus:
	- "countWide" – [required; integer] – Specifies number of object instances to place in a row from lesser "x" to a greater "x" value
	- "countDeep" – [required; integer] – Specifies number of object instances to place in a row from lesser "z" to a greater "z" value
	- "lengthOffset" – [optional; number, default is "0"] – Specifies in size units the offset between objects along the "x" axis when they are placed, if a negative value the objects may overlap
	- "widthOffset" – [optional; number, default is "0"] – Specifies in size units the offset between objects along the "x" axis when they are placed, if a negative value the objects may overlap

* TODO: Other builtin placers as we add them.

NOTE: "linear-series" and "rectangle" placement objects only place along the "x" and "z" axis's. The "y" axis is fixed from the placement's position.

TODO: Consider ways to do "y" axis placement.

TODO: Determine if we need other builtin placement algorithms.

## Events

Events are a JSON array of JSON objects specifying zero or more 'Event Declarations'; each for a single loaded object. Each Event Declaration may specify zero to many events for the object.

## Event Declarations

Event Declarations specify a named object, which must have been loaded as a resource in the current module, loaded as a resource in a separate module belonging to the same world, or included as a "builtin" by the runtime. All of the contained Event Specifications are for the same object.

WARNING! Specifying an object name that is not loaded results in undefined behavior. 

## Event Specifications

Event Specifications specify a single event for an object, consisting of an attacher hook function to attach the event to the object, an event name, and the options and data related to that event. When an event of the event type occurs for the object, the source object, options, and data are sent to all event handlers associated with the event name. For more on event handlers, see Wiring Events.

Standard data values for all Event Specifications include:

* "object" – [required; the name of an object previously placed in the World Space] – Specifies the object the event is attached to

* "attacher" – [optional, string containing an event attachment hook name, default is 'default'] – Specifies the event attachment hook function

* "event-name" – [required; string] – Specifies the name event handlers for the event are attached to

4. "options" – (object; optional) – option values to pass to the event handler when the event occurs (See also, Options above)

5. "data" – (any type; optional) – data value(s) to pass to the event handler when the event occurs (See also, Data above)

### Event Types

TODO: 
